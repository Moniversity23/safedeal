<!DOCTYPE html>
<html>
<head>
    <title>Officer Dashboard</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <h1>Welcome, <%= user.fullName %> (Loan Officer)</h1>
        <a href="/logout">Logout</a>
        <hr>

        <p style="margin-bottom: 2rem;">
            <!-- This link allows the officer to go to any day to mark payments -->
            <a href="/daily/<%= today %>">View/Confirm Payments for <%= today %> (Go to any day)</a>
        </p>

        <h2>Collection Summary & Loan Overview</h2>
        
        <!-- START: UPDATED KPI SECTION -->
        <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 2rem;">
            <!-- New: Total Loans Disbursed KPI (Reflects total loan amount) -->
            <!--<div class="summary-kpi" style="border-left-color: #3498db;">
                Total Loans Disbursed: <strong>â‚¦<%= totalLoansAmount.toFixed(0) %></strong>
            </div>-->

            <div class="summary-kpi" style="border-left-color: #e67e22;">
                Expected DUE Today: <strong>â‚¦<%= todayExpected.toFixed(0) %></strong>
            </div>
            <div class="summary-kpi" style="border-left-color: #2ecc71;">
                Collected TODAY: <strong>â‚¦<%= todayCollected.toFixed(0) %></strong>
            </div>
        </div>
        <!-- END: UPDATED KPI SECTION -->

        <% if (defaulters.length > 0) { %>
            <h3 style="color: #c0392b; margin-top: 3rem;">Borrowers Due & Unpaid Today (<%= today %>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Borrower</th>
                        <th>Expected</th>
                        <th>Collected</th>
                    </tr>
                </thead>
                <tbody>
                    <% defaulters.forEach(d => { %>
                        <tr class="status-default">
                            <td><%= d.borrower %></td>
                            <td>â‚¦<%= d.expected.toFixed(0) %></td>
                            <td>â‚¦<%= d.collected.toFixed(0) %></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        <% } else { %>
            <p style="color: green; margin-top: 3rem;">All borrowers due today have paid or are not due yet! ðŸŽ‰</p>
        <% } %>
    </div>
</body>
</html>
